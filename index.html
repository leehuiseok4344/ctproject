<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>DNA ì—¼ê¸° ì„œì—´ ì¶”ë¡  - ì»´í“¨íŒ… ì‚¬ê³  ê¸°ë°˜ í™œë™</title>
  <style>
    body { font-family: 'Arial', sans-serif'; background: #f4f4f4; padding: 20px; }
    h1 { color: #333; }
    .tab { display: none; padding: 20px; background: #fff; border: 1px solid #ccc; border-top: none; }
    .tab-buttons button {
      padding: 10px 20px; margin-right: 10px;
      border: 1px solid #ccc; background: #eee; cursor: pointer;
    }
    .tab-buttons button.active { background: #fff; border-bottom: none; font-weight: bold; }
    .seq { font-family: monospace; font-size: 18px; }
    .base-input { width: 25px; text-align: center; }
    input[type="text"] { padding: 5px; font-size: 16px; }
    #result, #abstraction-result, #decomposition-result { margin-top: 15px; }
  </style>
</head>
<body>

<h1>DNA ì—¼ê¸° ì„œì—´ ì¶”ë¡ í•˜ê¸° - ì»´í“¨íŒ… ì‚¬ê³  ê¸°ë°˜</h1>
<div class="tab-buttons">
  <button onclick="showTab('decomposition')" id="btn-decomposition">ë¬¸ì œ ë¶„í•´</button>
  <button onclick="showTab('abstraction')" id="btn-abstraction">ì¶”ìƒí™”</button>
  <button onclick="showTab('pattern')" id="btn-pattern">íŒ¨í„´ ë° ê·œì¹™ ì°¾ê¸°</button>
</div>

<!-- ë¬¸ì œ ë¶„í•´ -->
<div class="tab" id="decomposition">
  <h2>ğŸ§© ë¬¸ì œ ë¶„í•´</h2>
  <p>ë¬¸ì œ ì¡°ê±´ì„ ì…ë ¥í•˜ì—¬ ë‚˜ë§Œì˜ ë¬¸ì œë¥¼ ë§Œë“¤ì–´ ë´…ë‹ˆë‹¤.</p>
  <label>ì—¼ê¸° ì„œì—´ ê¸¸ì´: <input type="number" id="decomp-length" min="4" max="20" value="8"></label>
  <br><br>
  <button onclick="generateDecomposition()">ë¬¸ì œ ìƒì„±</button>
  <div id="decomposition-result"></div>
</div>

<!-- ì¶”ìƒí™” -->
<div class="tab" id="abstraction">
  <h2>ğŸ§Š ì¶”ìƒí™”</h2>
  <p>ë‹¤ìŒ ì—¼ê¸°ì„œì—´ì—ì„œ í•µì‹¬ ê·œì¹™ë§Œì„ ë‚¨ê¸°ê³  ë¶ˆí•„ìš”í•œ ì •ë³´ë¥¼ ì œê±°í•´ ë³´ì„¸ìš”.</p>
  <p><strong>ë¬¸ì œ:</strong> ë‹¤ìŒ ì„œì—´ ì¤‘ G-C ê·œì¹™ì„ ë”°ë¥´ì§€ ì•ŠëŠ” ìŒì„ ì°¾ì•„ë³´ì„¸ìš”.</p>
  <div class="seq" id="abstraction-question"></div>
  <br>
  <label>í‹€ë¦° ìœ„ì¹˜ ë²ˆí˜¸ ì…ë ¥ (0ë¶€í„° ì‹œì‘, ì‰¼í‘œë¡œ êµ¬ë¶„):<br>
    <input type="text" id="abstraction-answer" placeholder="ì˜ˆ: 2,5,7">
  </label>
  <br><br>
  <button onclick="checkAbstraction()">ì •ë‹µ ì œì¶œ</button>
  <div id="abstraction-result"></div>
</div>

<!-- íŒ¨í„´ -->
<div class="tab" id="pattern">
  <h2>ğŸ” íŒ¨í„´ ë° ê·œì¹™ ì°¾ê¸°</h2>
  <p>ê°€ë ¤ì§„ ë¶€ë¶„ì˜ ì—¼ê¸°ë¥¼ ì¶”ë¡ í•´ ë³´ì„¸ìš”. Aâ†”T, Gâ†”C ê·œì¹™ì„ ì‚¬ìš©í•˜ì„¸ìš”.</p>
  <div class="seq" id="pattern-top"></div>
  <div class="seq" id="pattern-bottom"></div>
  <br>
  <button onclick="submitPattern()">ì •ë‹µ ì œì¶œ</button>
  <div id="result"></div>
</div>

<script>
  let currentTop = '';
  let maskedIndices = [];

  const basePair = { 'A': 'T', 'T': 'A', 'G': 'C', 'C': 'G' };

  function showTab(id) {
    document.querySelectorAll('.tab').forEach(tab => tab.style.display = 'none');
    document.querySelectorAll('.tab-buttons button').forEach(btn => btn.classList.remove('active'));
    document.getElementById(id).style.display = 'block';
    document.getElementById('btn-' + id).classList.add('active');

    if (id === 'abstraction') generateAbstraction();
    if (id === 'pattern') startPattern();
  }

  // ë¬¸ì œ ë¶„í•´
  function generateDecomposition() {
    const len = parseInt(document.getElementById('decomp-length').value);
    const seq = Array.from({ length: len }, () => randomBase()).join('');
    document.getElementById('decomposition-result').innerHTML = `
      <p><strong>ìƒì„±ëœ ë¬¸ì œ:</strong> DNA ì„œì—´: ${seq}</p>
      <p>ì´ ì„œì—´ì˜ ìƒë³´ì  ê°€ë‹¥ì„ êµ¬í•˜ê³ , ê·œì¹™ì„ ì„¤ëª…í•´ë³´ì„¸ìš”.</p>
    `;
  }

  // ì¶”ìƒí™”
  function generateAbstraction() {
    const bases = ['G', 'C'];
    let top = '';
    let bottom = '';
    for (let i = 0; i < 10; i++) {
      const b = bases[Math.floor(Math.random() * bases.length)];
      top += b;
      bottom += Math.random() < 0.7 ? basePair[b] : randomBase();  // ì¼ë¶€ ì˜¤ë¥˜ ì‚½ì…
    }
    document.getElementById('abstraction-question').textContent = `Top: ${top} / Bottom: ${bottom}`;
    document.getElementById('abstraction-answer').value = '';
    document.getElementById('abstraction-result').innerHTML = '';
    document.getElementById('abstraction-question').dataset.top = top;
    document.getElementById('abstraction-question').dataset.bottom = bottom;
  }

  function checkAbstraction() {
    const top = document.getElementById('abstraction-question').dataset.top;
    const bottom = document.getElementById('abstraction-question').dataset.bottom;
    let wrong = [];
    for (let i = 0; i < top.length; i++) {
      if (basePair[top[i]] !== bottom[i]) wrong.push(i);
    }
    const userInput = document.getElementById('abstraction-answer').value.split(',').map(x => parseInt(x.trim())).filter(x => !isNaN(x));
    const correctCount = userInput.filter(x => wrong.includes(x)).length;
    const result = `ì´ ${wrong.length}ê°œì˜ ì˜¤ë¥˜ ì¤‘ ${correctCount}ê°œë¥¼ ì •í™•íˆ ì°¾ì•˜ìŠµë‹ˆë‹¤.`;
    document.getElementById('abstraction-result').innerHTML = result;
  }

  // íŒ¨í„´
  function startPattern() {
    const length = 10;
    currentTop = '';
    maskedIndices = [];
    let topHTML = '';
    let bottomHTML = '';
    for (let i = 0; i < length; i++) {
      const base = randomBase();
      currentTop += base;
      const isMasked = Math.random() < 0.3;
      if (isMasked) {
        topHTML += `<input type="text" maxlength="1" class="base-input" data-index="${i}" />`;
        maskedIndices.push(i);
      } else {
        topHTML += `<span>${base}</span>`;
      }
      bottomHTML += `<span>${basePair[base]}</span>`;
    }
    document.getElementById('pattern-top').innerHTML = `5â€²â€“ ${topHTML} â€“3â€²`;
    document.getElementById('pattern-bottom').innerHTML = `3â€²â€“ ${bottomHTML} â€“5â€²`;
    document.getElementById('result').innerHTML = '';
  }

  function submitPattern() {
    let correct = 0;
    maskedIndices.forEach(i => {
      const input = document.querySelector(`input[data-index="${i}"]`);
      const expected = currentTop[i];
      const entered = input.value.toUpperCase();
      if (entered === expected) {
        input.style.border = '2px solid green';
        correct++;
      } else {
        input.style.border = '2px solid red';
      }
    });
    document.getElementById('result').innerHTML = `ì •ë‹µ: ${correct} / ${maskedIndices.length} ê°œ ë§ì¶¤`;
  }

  function randomBase() {
    const b = ['A', 'T', 'G', 'C'];
    return b[Math.floor(Math.random() * b.length)];
  }

  // ê¸°ë³¸ íƒ­ ì—´ê¸°
  showTab('decomposition');
</script>

</body>
</html>
